@model VisitingCardViewModel
@{
    ViewData["Title"] = "Create Visiting Card";
}

<div class="row">
    <div class="col-md-8">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-gradient text-white" style="background: linear-gradient(135deg, #3456a3, #5478c4);">
                <div class="d-flex align-items-center">
                    <i class="fas fa-plus-circle me-3 fa-lg"></i>
                    <div>
                        <h4 class="mb-0">Create New Visiting Card</h4>
                        <small class="opacity-75">Design your professional digital card</small>
                    </div>
                </div>
            </div>
            <div class="card-body p-4">
                <form asp-action="Create" method="post" id="cardForm" enctype="multipart/form-data">
                    <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>
                    
                    <!-- Basic Information -->
                    <div class="mb-4">
                        <h5 class="text-primary border-bottom pb-2 mb-3">
                            <i class="fas fa-user me-2"></i>Basic Information
                        </h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="FirstName" class="form-label">First Name</label>
                                    <input asp-for="FirstName" class="form-control" placeholder="Your first name" />
                                    <span asp-validation-for="FirstName" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="LastName" class="form-label">Last Name</label>
                                    <input asp-for="LastName" class="form-control" placeholder="Your last name" />
                                    <span asp-validation-for="LastName" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="mb-3">
                                    <label asp-for="Email" class="form-label">Email</label>
                                    <input asp-for="Email" class="form-control" type="email" placeholder="your.email@example.com" />
                                    <span asp-validation-for="Email" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="JobTitle" class="form-label"></label>
                                    <input asp-for="JobTitle" class="form-control" placeholder="e.g., Software Engineer" />
                                    <span asp-validation-for="JobTitle" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="Company" class="form-label"></label>
                                    <input asp-for="Company" class="form-control" />
                                    <span asp-validation-for="Company" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="Phone" class="form-label"></label>
                                    <input asp-for="Phone" class="form-control" />
                                    <span asp-validation-for="Phone" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="Website" class="form-label"></label>
                                    <input asp-for="Website" class="form-control" placeholder="https://yourwebsite.com" />
                                    <span asp-validation-for="Website" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label asp-for="Address" class="form-label"></label>
                            <textarea asp-for="Address" class="form-control" rows="2"></textarea>
                            <span asp-validation-for="Address" class="text-danger"></span>
                        </div>
                    </div>

                    <!-- Social Media Links -->
                    <div class="mb-4">
                        <h5 class="text-primary border-bottom pb-2 mb-3">
                            <i class="fas fa-share-alt me-2"></i>Social Media Links
                        </h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="LinkedIn" class="form-label">
                                        <i class="fab fa-linkedin text-primary me-1"></i>LinkedIn
                                    </label>
                                    <input asp-for="LinkedIn" class="form-control" placeholder="https://linkedin.com/in/your-profile" />
                                    <span asp-validation-for="LinkedIn" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="Twitter" class="form-label">
                                        <i class="fab fa-twitter text-info me-1"></i>Twitter
                                    </label>
                                    <input asp-for="Twitter" class="form-control" placeholder="https://twitter.com/yourusername" />
                                    <span asp-validation-for="Twitter" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="Instagram" class="form-label">
                                        <i class="fab fa-instagram text-danger me-1"></i>Instagram
                                    </label>
                                    <input asp-for="Instagram" class="form-control" placeholder="https://instagram.com/yourusername" />
                                    <span asp-validation-for="Instagram" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="Facebook" class="form-label">
                                        <i class="fab fa-facebook text-primary me-1"></i>Facebook
                                    </label>
                                    <input asp-for="Facebook" class="form-control" placeholder="https://facebook.com/yourprofile" />
                                    <span asp-validation-for="Facebook" class="text-danger"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Professional Details -->
                    <div class="mb-4">
                        <h5 class="text-primary border-bottom pb-2 mb-3">
                            <i class="fas fa-briefcase me-2"></i>Professional Details
                        </h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="Skills" class="form-label"></label>
                                    <textarea asp-for="Skills" class="form-control" rows="2" placeholder="e.g., JavaScript, React, Node.js"></textarea>
                                    <span asp-validation-for="Skills" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="Languages" class="form-label"></label>
                                    <input asp-for="Languages" class="form-control" placeholder="e.g., English, Spanish, French" />
                                    <span asp-validation-for="Languages" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label asp-for="AvailabilityStatus" class="form-label"></label>
                            <select asp-for="AvailabilityStatus" class="form-select">
                                <option value="">Select availability status</option>
                                <option value="Available">Available for opportunities</option>
                                <option value="Open to work">Open to work</option>
                                <option value="Not available">Not available</option>
                                <option value="Freelancing">Available for freelancing</option>
                            </select>
                            <span asp-validation-for="AvailabilityStatus" class="text-danger"></span>
                        </div>
                    </div>

                    <!-- Design Customization -->
                    <div class="mb-4">
                        <h5 class="text-primary border-bottom pb-2 mb-3">
                            <i class="fas fa-palette me-2"></i>Design & Customization
                        </h5>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label asp-for="PrimaryColor" class="form-label"></label>
                                    <input asp-for="PrimaryColor" type="color" class="form-control form-control-color" value="#3456a3" />
                                    <span asp-validation-for="PrimaryColor" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label asp-for="SecondaryColor" class="form-label"></label>
                                    <input asp-for="SecondaryColor" type="color" class="form-control form-control-color" value="#5478c4" />
                                    <span asp-validation-for="SecondaryColor" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label asp-for="FontFamily" class="form-label"></label>
                                    <select asp-for="FontFamily" class="form-select">
                                        <option value="Arial">Arial</option>
                                        <option value="Helvetica">Helvetica</option>
                                        <option value="Times New Roman">Times New Roman</option>
                                        <option value="Georgia">Georgia</option>
                                        <option value="Verdana">Verdana</option>
                                    </select>
                                    <span asp-validation-for="FontFamily" class="text-danger"></span>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label asp-for="CardOrientation" class="form-label"></label>
                                    <select asp-for="CardOrientation" class="form-select">
                                        <option value="Landscape">Landscape</option>
                                        <option value="Portrait">Portrait</option>
                                    </select>
                                    <span asp-validation-for="CardOrientation" class="text-danger"></span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="logoFile" class="form-label">Logo Upload</label>
                                    <input type="file" name="logoFile" class="form-control" accept="image/*" />
                                    <div class="form-text">Upload your company logo (Max 5MB, JPG/PNG/GIF)</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Template Selection -->
                    <div class="mb-4">
                        <h5 class="text-primary border-bottom pb-2 mb-3">
                            <i class="fas fa-layer-group me-2"></i>Template Selection
                        </h5>
                        
                        <div class="mb-3">
                            <label asp-for="TemplateId" class="form-label"></label>
                            <select asp-for="TemplateId" class="form-select" id="templateSelect">
                                <option value="">Select a template</option>
                                @foreach (var template in ViewBag.Templates as List<Template>)
                                {
                                    <option value="@template.TemplateId">@template.TemplateName</option>
                                }
                            </select>
                            <span asp-validation-for="TemplateId" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary">Create Visiting Card</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card border-0 shadow-sm position-sticky" style="top: 2rem;">
            <div class="card-header bg-light border-0">
                <div class="d-flex align-items-center">
                    <i class="fas fa-eye text-primary me-2"></i>
                    <h5 class="mb-0 text-primary">Live Preview</h5>
                </div>
                <small class="text-muted">See changes in real-time</small>
            </div>
            <div class="card-body">
                <div id="cardPreview" class="card-preview">
                    <div class="preview-placeholder">
                        <div class="text-center p-4">
                            <div class="mb-3">
                                <i class="fas fa-id-card fa-3x text-muted"></i>
                            </div>
                            <h6 class="text-muted">Choose a template</h6>
                            <p class="text-muted small mb-0">Your card preview will appear here</p>
                        </div>
                    </div>
                </div>
                
                <!-- Quick tips -->
                <div class="mt-3 p-3 bg-light rounded">
                    <h6 class="text-primary mb-2">
                        <i class="fas fa-lightbulb me-1"></i>Quick Tips
                    </h6>
                    <ul class="small text-muted mb-0">
                        <li>Fill out all fields for best results</li>
                        <li>LinkedIn URL is optional but recommended</li>
                        <li>QR code updates automatically</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script>
        $(document).ready(function() {
            // Update preview when any field changes (real-time)
            $('#templateSelect, input[type="text"], input[type="email"], input[type="tel"], textarea, select').on('change keyup input', function() {
                updatePreview();
            });
            
            // Initial preview
            updatePreview();
            
            function updatePreview() {
                var templateId = $('#templateSelect').val();
                
                // Get all form values
                var data = {
                    fullName: '@Model.FullName',
                    email: '@Model.Email',
                    firstName: $('input[name="FirstName"]').val() || '',
                    lastName: $('input[name="LastName"]').val() || '',
                    jobTitle: $('input[name="JobTitle"]').val() || '',
                    phone: $('input[name="Phone"]').val() || '',
                    company: $('input[name="Company"]').val() || '',
                    linkedin: $('input[name="LinkedIn"]').val() || '',
                    instagram: $('input[name="Instagram"]').val() || '',
                    twitter: $('input[name="Twitter"]').val() || '',
                    facebook: $('input[name="Facebook"]').val() || '',
                    website: $('input[name="Website"]').val() || '',
                    address: $('textarea[name="Address"]').val() || '',
                    skills: $('textarea[name="Skills"]').val() || '',
                    languages: $('input[name="Languages"]').val() || '',
                    availabilityStatus: $('select[name="AvailabilityStatus"]').val() || ''
                };
                
                if (templateId) {
                    var previewHtml = generatePreview(templateId, data);
                    $('#cardPreview').html(previewHtml);
                } else {
                    $('#cardPreview').html('<div class="preview-placeholder"><i class="fas fa-id-card fa-3x text-muted"></i><p class="text-muted mt-2">Choose a template to see live preview</p></div>');
                }
            }
            
            function generatePreview(templateId, data) {
                const displayName = (data.firstName && data.lastName) ? `${data.firstName} ${data.lastName}` : data.fullName;
                
                switch(templateId) {
                    case '1': // Classic Blue
                        return `<div class="classic-blue-template p-4" style="border-radius: 15px; box-shadow: 0 8px 25px rgba(52, 86, 163, 0.3);">
                            <div class="d-flex justify-content-between align-items-start">
                                <div style="flex: 1;">
                                    <h4 class="text-white mb-1">${displayName}</h4>
                                    ${data.jobTitle ? `<h6 class="text-white-50 mb-1">${data.jobTitle}</h6>` : ''}
                                    ${data.company ? `<h6 class="text-white-50 mb-3">${data.company}</h6>` : '<div class="mb-3"></div>'}
                                    <div class="text-white">
                                        ${data.email ? `<div class="mb-2"><i class="fas fa-envelope me-2"></i><span>${data.email}</span></div>` : ''}
                                        ${data.phone ? `<div class="mb-2"><i class="fas fa-phone me-2"></i><span>${data.phone}</span></div>` : ''}
                                        ${data.linkedin ? `<div class="mb-2"><i class="fab fa-linkedin me-2"></i><span>${data.linkedin}</span></div>` : ''}
                                        ${data.instagram ? `<div class="mb-2"><i class="fab fa-instagram me-2"></i><span>${data.instagram}</span></div>` : ''}
                                        ${data.twitter ? `<div class="mb-2"><i class="fab fa-twitter me-2"></i><span>${data.twitter}</span></div>` : ''}
                                        ${data.facebook ? `<div class="mb-2"><i class="fab fa-facebook me-2"></i><span>${data.facebook}</span></div>` : ''}
                                        ${data.website ? `<div class="mb-2"><i class="fas fa-globe me-2"></i><span>${data.website}</span></div>` : ''}
                                        ${data.address ? `<div class="mb-2"><i class="fas fa-map-marker-alt me-2"></i><span>${data.address}</span></div>` : ''}
                                        ${data.skills ? `<div class="mt-2"><i class="fas fa-tools me-2"></i><small>${data.skills}</small></div>` : ''}
                                        ${data.languages ? `<div class="mt-1"><i class="fas fa-language me-2"></i><small>${data.languages}</small></div>` : ''}
                                        ${data.availabilityStatus ? `<div class="mt-1"><i class="fas fa-check-circle me-2"></i><small>${data.availabilityStatus}</small></div>` : ''}
                                    </div>
                                </div>
                                <div class="qr-code" style="margin-left: 15px;">
                                    <div class="bg-white bg-opacity-20 rounded p-2" style="width: 80px; height: 80px;">
                                        <i class="fas fa-qrcode fa-3x text-white opacity-75"></i>
                                    </div>
                                </div>
                            </div>
                        </div>`;
                        
                    case '2': // Minimal White
                        return `<div class="minimal-white-template p-4" style="background: #ffffff; border: 2px solid #e9ecef; border-radius: 15px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
                            <div class="d-flex justify-content-between align-items-start">
                                <div style="flex: 1;">
                                    <h4 class="text-dark mb-1">${displayName}</h4>
                                    ${data.jobTitle ? `<h6 class="text-muted mb-1">${data.jobTitle}</h6>` : ''}
                                    ${data.company ? `<h6 class="text-muted mb-3">${data.company}</h6>` : '<div class="mb-3"></div>'}
                                    <div class="text-dark">
                                        ${data.email ? `<div class="mb-2"><i class="fas fa-envelope me-2 text-primary"></i><span>${data.email}</span></div>` : ''}
                                        ${data.phone ? `<div class="mb-2"><i class="fas fa-phone me-2 text-primary"></i><span>${data.phone}</span></div>` : ''}
                                        ${data.linkedin ? `<div class="mb-2"><i class="fab fa-linkedin me-2 text-primary"></i><span>${data.linkedin}</span></div>` : ''}
                                        ${data.instagram ? `<div class="mb-2"><i class="fab fa-instagram me-2 text-primary"></i><span>${data.instagram}</span></div>` : ''}
                                        ${data.twitter ? `<div class="mb-2"><i class="fab fa-twitter me-2 text-primary"></i><span>${data.twitter}</span></div>` : ''}
                                        ${data.facebook ? `<div class="mb-2"><i class="fab fa-facebook me-2 text-primary"></i><span>${data.facebook}</span></div>` : ''}
                                        ${data.website ? `<div class="mb-2"><i class="fas fa-globe me-2 text-primary"></i><span>${data.website}</span></div>` : ''}
                                        ${data.address ? `<div class="mb-2"><i class="fas fa-map-marker-alt me-2 text-primary"></i><span>${data.address}</span></div>` : ''}
                                        ${data.skills ? `<div class="mt-2"><i class="fas fa-tools me-2 text-primary"></i><small>${data.skills}</small></div>` : ''}
                                        ${data.languages ? `<div class="mt-1"><i class="fas fa-language me-2 text-primary"></i><small>${data.languages}</small></div>` : ''}
                                        ${data.availabilityStatus ? `<div class="mt-1"><i class="fas fa-check-circle me-2 text-primary"></i><small>${data.availabilityStatus}</small></div>` : ''}
                                    </div>
                                </div>
                                <div class="qr-code" style="margin-left: 15px;">
                                    <div class="border rounded p-2" style="width: 80px; height: 80px; background: #f8f9fa;">
                                        <i class="fas fa-qrcode fa-3x text-primary opacity-75"></i>
                                    </div>
                                </div>
                            </div>
                        </div>`;
                        
                    case '3': // Modern Dark
                        return `<div class="modern-dark-template p-4" style="background: linear-gradient(135deg, #212529, #343a40); border-radius: 15px; box-shadow: 0 8px 25px rgba(33, 37, 41, 0.4);">
                            <div class="d-flex justify-content-between align-items-start">
                                <div style="flex: 1;">
                                    <h4 class="text-warning mb-1">${displayName}</h4>
                                    ${data.jobTitle ? `<h6 class="text-light mb-1">${data.jobTitle}</h6>` : ''}
                                    ${data.company ? `<h6 class="text-light mb-3">${data.company}</h6>` : '<div class="mb-3"></div>'}
                                    <div class="text-light">
                                        ${data.email ? `<div class="mb-2"><i class="fas fa-envelope me-2 text-warning"></i><span>${data.email}</span></div>` : ''}
                                        ${data.phone ? `<div class="mb-2"><i class="fas fa-phone me-2 text-warning"></i><span>${data.phone}</span></div>` : ''}
                                        ${data.linkedin ? `<div class="mb-2"><i class="fab fa-linkedin me-2 text-warning"></i><span>${data.linkedin}</span></div>` : ''}
                                        ${data.instagram ? `<div class="mb-2"><i class="fab fa-instagram me-2 text-warning"></i><span>${data.instagram}</span></div>` : ''}
                                        ${data.twitter ? `<div class="mb-2"><i class="fab fa-twitter me-2 text-warning"></i><span>${data.twitter}</span></div>` : ''}
                                        ${data.facebook ? `<div class="mb-2"><i class="fab fa-facebook me-2 text-warning"></i><span>${data.facebook}</span></div>` : ''}
                                        ${data.website ? `<div class="mb-2"><i class="fas fa-globe me-2 text-warning"></i><span>${data.website}</span></div>` : ''}
                                        ${data.address ? `<div class="mb-2"><i class="fas fa-map-marker-alt me-2 text-warning"></i><span>${data.address}</span></div>` : ''}
                                        ${data.skills ? `<div class="mt-2"><i class="fas fa-tools me-2 text-warning"></i><small>${data.skills}</small></div>` : ''}
                                        ${data.languages ? `<div class="mt-1"><i class="fas fa-language me-2 text-warning"></i><small>${data.languages}</small></div>` : ''}
                                        ${data.availabilityStatus ? `<div class="mt-1"><i class="fas fa-check-circle me-2 text-warning"></i><small>${data.availabilityStatus}</small></div>` : ''}
                                    </div>
                                </div>
                                <div class="qr-code" style="margin-left: 15px;">
                                    <div class="bg-warning bg-opacity-20 rounded p-2" style="width: 80px; height: 80px;">
                                        <i class="fas fa-qrcode fa-3x text-warning opacity-75"></i>
                                    </div>
                                </div>
                            </div>
                        </div>`;
                        
                    default:
                        return '<div class="preview-placeholder text-center py-5"><i class="fas fa-id-card fa-3x text-muted mb-3"></i><h5 class="text-muted">Choose a template</h5><p class="text-muted">Your card preview will appear here</p></div>';
                }
            }
        });
    </script>
}